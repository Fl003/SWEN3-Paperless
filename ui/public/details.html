<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Paperless – Document Details</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="./styles.css" rel="stylesheet" />
</head>
<body>
<header>
    <h1>Document Details</h1>
    <a href="./index.html">← Back to list</a>
</header>
<main id="details">
    <div id="status" class="muted">Loading…</div>
    <div id="doc" class="hidden">
        <p><b>ID:</b> <span id="docId"></span></p>
        <p><b>Title:</b> <span id="docTitle"></span></p>
        <p><b>Created:</b> <span id="docCreated"></span></p>
        <p><b>Tags:</b> <span id="docTags"></span></p>
        <pre id="docJson"></pre>
    </div>
</main>
<script>
    (async function () {
        const params = new URLSearchParams(location.search);
        const id = params.get('id');
        const status = document.getElementById('status');
        const box = document.getElementById('doc');

        if (!id) { status.textContent = 'Missing id parameter.'; return; }

        try {
            const res = await fetch(`/api/v1/documents/${encodeURIComponent(id)}`);
            if (!res.ok) throw new Error(`HTTP ${res.status}`);
            const doc = await res.json();

            document.getElementById('docId').textContent = doc.id ?? id;
            document.getElementById('docTitle').textContent = doc.title ?? doc.filename ?? '(untitled)';
            document.getElementById('docCreated').textContent = doc.createdAt ?? doc.created ?? '—';
            document.getElementById('docTags').textContent = (doc.tags || []).join(', ');
            document.getElementById('docJson').textContent = JSON.stringify(doc, null, 2);

            status.classList.add('hidden'); box.classList.remove('hidden');
        } catch (err) { status.textContent = `Failed to load: ${err.message}`; }
    })();
</script>
</body>
</html>